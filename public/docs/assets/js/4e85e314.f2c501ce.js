"use strict";(globalThis.webpackChunkai_book_platform=globalThis.webpackChunkai_book_platform||[]).push([[8656],{1359(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"rag-pipeline","title":"RAG Pipeline","description":"Overview","source":"@site/docs/rag-pipeline.md","sourceDirName":".","slug":"/rag-pipeline","permalink":"/docs/docs/rag-pipeline","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/rag-pipeline.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Curriculum Structure","permalink":"/docs/docs/curriculum"},"next":{"title":"Development","permalink":"/docs/docs/development"}}');var i=s(4848),t=s(8453);const l={sidebar_position:5},o="RAG Pipeline",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Pipeline Components",id:"pipeline-components",level:2},{value:"1. Content Loading",id:"1-content-loading",level:3},{value:"2. Content Processing",id:"2-content-processing",level:3},{value:"3. Chunking Strategy",id:"3-chunking-strategy",level:3},{value:"4. Embedding Generation",id:"4-embedding-generation",level:3},{value:"5. Vector Storage",id:"5-vector-storage",level:3},{value:"6. Retrieval Process",id:"6-retrieval-process",level:3},{value:"7. Response Generation",id:"7-response-generation",level:3},{value:"RAG Rules",id:"rag-rules",level:2},{value:"Strict Context Adherence",id:"strict-context-adherence",level:3},{value:"Citation Requirement",id:"citation-requirement",level:3},{value:"Quality Assurance",id:"quality-assurance",level:3},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"<code>/load-content</code> (POST)",id:"load-content-post",level:3},{value:"<code>/chat</code> (POST)",id:"chat-post",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rag-pipeline",children:"RAG Pipeline"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The Retrieval-Augmented Generation (RAG) pipeline is the core of the AI Book Platform's intelligent assistance system. It enables the chatbot to answer questions based on the curriculum content while enforcing strict adherence to the provided context."}),"\n",(0,i.jsx)(n.h2,{id:"pipeline-components",children:"Pipeline Components"}),"\n",(0,i.jsx)(n.h3,{id:"1-content-loading",children:"1. Content Loading"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Source"}),": MDX files from ",(0,i.jsx)(n.code,{children:"book-app/src/content/chapters/"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Process"}),": Reads all ",(0,i.jsx)(n.code,{children:".mdx"})," files and extracts text content"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Metadata"}),": Preserves source file information and chunk indices"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-content-processing",children:"2. Content Processing"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Frontmatter Parsing"}),": Extracts title and description from MDX frontmatter"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Markdown Conversion"}),": Converts MDX content to HTML, then to plain text"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Text Cleaning"}),": Normalizes whitespace and removes excessive newlines"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-chunking-strategy",children:"3. Chunking Strategy"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Method"}),": Paragraph-based chunking"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Size"}),": Approximately 1000 characters per chunk"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": Preserves paragraph boundaries to maintain context coherence"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"4-embedding-generation",children:"4. Embedding Generation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Model"}),": Cohere's ",(0,i.jsx)(n.code,{children:"embed-multilingual-v3.0"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dimensions"}),": 4096-dimensional vectors"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Storage"}),": Vectors stored in Qdrant with content metadata"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"5-vector-storage",children:"5. Vector Storage"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Database"}),": Qdrant vector database"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Collection"}),": ",(0,i.jsx)(n.code,{children:"ai_book_content"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Schema"}),": Content, source file, chunk index, and title"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Distance"}),": Cosine similarity for similarity search"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"6-retrieval-process",children:"6. Retrieval Process"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Query Embedding"}),": User queries are embedded using the same model"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Search"}),": Vector similarity search in Qdrant"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Results"}),": Top-k most relevant content chunks returned"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Metadata"}),": Source attribution preserved for citations"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"7-response-generation",children:"7. Response Generation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Context Assembly"}),": Retrieved chunks are combined into context"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Prompt Engineering"}),": Context and query are formatted for the LLM"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Generation"}),": Cohere's ",(0,i.jsx)(n.code,{children:"command-xlarge-nightly"})," model generates response"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Citation"}),": Source files are provided for transparency"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"rag-rules",children:"RAG Rules"}),"\n",(0,i.jsx)(n.h3,{id:"strict-context-adherence",children:"Strict Context Adherence"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rule"}),": Never answer outside retrieved context"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implementation"}),": If no relevant context is found, the system refuses to answer"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Fallback"}),": Directs users to rephrase or ask about covered topics"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"citation-requirement",children:"Citation Requirement"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rule"}),": Always cite chapter + topic when answering"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implementation"}),": Source metadata is preserved and returned with responses"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Format"}),": Citations include source file and relevance score"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"quality-assurance",children:"Quality Assurance"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Relevance Threshold"}),": Only highly relevant chunks are included in context"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Context Validation"}),": Ensures retrieved content is directly related to the query"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Response Verification"}),": Generated responses are checked against source content"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,i.jsxs)(n.h3,{id:"load-content-post",children:[(0,i.jsx)(n.code,{children:"/load-content"})," (POST)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Load and index all MDX content into vector database"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Trigger"}),": Called on application startup and manually when needed"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Process"}),": Full re-indexing of all curriculum content"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"chat-post",children:[(0,i.jsx)(n.code,{children:"/chat"})," (POST)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Process user queries using the RAG pipeline"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Input"}),": User query and optional user ID"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Output"}),": Generated response with citations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Process"}),": Embed query \u2192 Search vectors \u2192 Generate response"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Indexing Time"}),": Initial content loading may take several minutes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Query Latency"}),": Vector search and response generation under 2 seconds"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Memory Usage"}),": Optimized for efficient vector storage and retrieval"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Scalability"}),": Qdrant supports horizontal scaling for larger datasets"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>o});var r=s(6540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);